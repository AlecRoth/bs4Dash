---
title: "How to start?"
author: "David Granjon"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{How to start?}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

Below is a step by step introduction to the `{bs4Dash}` structure. 

## Create a basic page 

This is the template to start with `{bs4Dash}`:

```{r basic-page, eval=FALSE}
library(shiny)
library(bs4Dash)

 shinyApp(
  ui = dashboardPage(
   title = "Basic Dashboard",
   header = dashboardHeader(),
   sidebar = dashboardSidebar(),
   controlbar = dashboardControlbar(),
   footer = dashboardFooter(),
   body = dashboardBody()
  ),
  server = function(input, output) {}
)
```

<img src="figures/bs4Dash_basicPage.png">
<br>

The `bs4DashPage()` takes optional argument such as ... TO DO

Now, it is time to fill this template!

## Sidebar Setup

Below we quickly describe the `dashboardSidebar()` function:

```{r sidebar, eval=FALSE}
dashboardSidebar(
 disable = FALSE,
 width = NULL,
 skin = "dark",
 status = "primary",
 elevation = 4,
 collapsed = FALSE,
 minified = TRUE,
 expandOnHover = TRUE,
 fixed = TRUE,
 id = "sidebar",
 customArea = NULL
 sidebarUserPanel(
  img = "https://image.flaticon.com/icons/svg/1149/1149168.svg", 
  text = "Welcome Onboard!"
 ),
 sidebarMenu(
   id = "sidebarmenu",
   sidebarHeader("Header 1"),
   menuItem(
     "Item 1",
     tabName = "item1",
     icon = icon("sliders")
   ),
   menuItem(
     "Item 2",
     tabName = "item2",
     icon = icon("id-card")
   )
 )
)
```

A lot of options are available:

    - __disable__ to disable the sidebar.
    - __width__ controls the sidebar width.
    - Two __skins__, namely "light" or "dark".
    - __elevation__ is a number between 0 and 5, which applies a shadow to the sidebar to
    add a shadow effect.
    - The sidebar status determins which color `menuItem()` have. 
    There are 20 different colors listed in `getAdminLTEColors()`.
    - __collapsed__ , if TRUE the sidebar is collapsed at start.
    - __minified__, if TRUE the sidebar is minified at start. What is the difference between collapse and minified?
    Minified means a little part of the sidebar is still visible. 
    - __expandOnHover__, when minified is TRUE, if this property is TRUE, the sidebar opens when hovering but re-collapses
    as soon as the focus is lost.
    - __fixed__, if TRUE, the sidebar has a vertical overflow, which allows to see all menus at once without
    scrolling up and down.
    - __id__ is used by the `updateSidebar()` function to programmatically toggle the sidebar on the server.
    `input$<id>` indicates the state of the sidebar: TRUE means open and FALSE means collapsed/minified.
    - __customArea__ is an area at the bottom of the sidebar to contain elements like buttons.

The skin switch feature allows to automatically toggle the sidebar skin. 

<img src="figures/bs4Dash_sidebar.png">
<br>

Importantly, the sidebar contains `sidebarMenu()` as well as other items like ...

## Navbar Setup

The `dashboardHeader()` function creates a navbar for `{bs4Dash}`:

```{r navbar, eval=FALSE}
dashboardHeader(
  title = NULL,
  titleWidth = NULL,
  disable = FALSE,
  .list = NULL,
  skin = "light",
  status = "white",
  border = TRUE,
  compact = FALSE,
  sidebarIcon = shiny::icon("bars"),
  controlbarIcon = shiny::icon("th"),
  fixed = FALSE,
  fullscreen = FALSE,
  help = FALSE
  leftUi = NULL,
  rightUi = NULL
)
```

<img src="figures/bs4Dash_navbar.png">
<br>

The __title__ parameter can host simple text but more complex content like `dashboardBrand()`:

```{r brand, eval=FALSE}
title <- dashboardBrand(
    title = "My dashboard",
    color = "primary",
    href = "https://adminlte.io/themes/v3",
    image = "https://adminlte.io/themes/v3/dist/img/AdminLTELogo.png"
)
```

`dashboardBrand()` is an enhanced title which has a color status, points to an optional url and may contain a logo.
The title width can be controlled by __titleWidth__, like in `{shinydashboard}`. Like `dashboardSidebar()`, 
`dashboardHeader()` offers a lot of theming options with __skin__ and __status__, but also with __border__ and 
__compact__. They respectively show a bottom border and smaller text. __sidebarIcon__ and __controlbarIcon__ control
icons for sidebar and controlbar, respectively. The __fixed__ parameter is useful when one wants to see the
navbar even at the bottom of the dashboard, without having to scroll up. When __fullscreen__ is TRUE, an icon is
displayed in the navbar to switch to full screen mode. __help__ automatically enable/disable all tooltips and popover
that are present in the shiny app. This is an easier approach than using the server methods `addPopover()`, 
`addTooltip()`, ... but less specific.

`leftUi`, `...` and `rightUi` are containers that can contains content from left to right. Ideally, we put
`dropdownMenu()` as well as `taskItem()`, `messageItem()`, `notificationItem()`, `dashboardUser()`...

## Right Sidebar Setup

`dashboardControlbar()` provides an extra sidebar, on the right side:

```{r controlbar, eval=FALSE}
dashboardControlbar(
    id = NULL,
    disable = FALSE,
    width = 250,
    collapsed = TRUE,
    overlay = TRUE,
    skin = "dark",
    pinned = NULL
)
```

<img src="figures/bs4Dash_controlbar.png">
<br>


## Footer Setup

We will use `dashboardFooter()`:

```{r footer, eval=FALSE}
dashboardFooter(
 left = a(
   href = "https://twitter.com/divadnojnarg", 
   target = "_blank", "@DivadNojnarg"
 ),
 right = "2018"
)
```

Nothing special to add here!

## Setting up the body content

This is the main dashboard container:

```{r body, eval=FALSE}
dashboardBody(
 tabItems(
   tabItem(
    tabName = "item1",
    fluidRow(
      lapply(1:3, FUN = function(i) {
        sortable(
          width = 4,
          p(class = "text-center", paste("Column", i)),
          lapply(1:2, FUN = function(j) {
            box(
              title = paste0("I am the ", j,"-th card of the ", i, "-th column"), 
              width = 12,
              "Click on my header"
            )
          })
        )
      })
    )
   ),
   tabItem(
     tabName = "item2",
     box(
       title = "Card with messages",
       width = 9,
       userMessages(
         width = 12,
         status = "success",
         userMessage(
           author = "Alexander Pierce",
           date = "20 Jan 2:00 pm",
           image = "https://adminlte.io/themes/AdminLTE/dist/img/user1-128x128.jpg",
           side = NULL,
           "Is this template really for free? That's unbelievable!"
         ),
         userMessage(
           author = "Dana Pierce",
           date = "21 Jan 4:00 pm",
           image = "https://adminlte.io/themes/AdminLTE/dist/img/user5-128x128.jpg",
           side = "right",
           "Indeed, that's unbelievable!"
         )
       )
     )
   )
 )
)
```

<img src="figures/bs4Dash_body.png">
<br>

The principle is pretty straightforward: all `dashboardBody()` elements must be embeded in a `tabItems()` 
list containing as may elements as the number of items. Each item is a `tabItem()`. 
Importantly, the *tabName* argument must be provide and unique. Moreover, it must be identical to the
corresponding `menuItem()`, so that the navigation between tabs work. 
This is exactly the same principle as for shinydashboard. Therefore, users should not be lost.

In practice, if the sidebar is empty (without menu), it is still possible to get rid of 
`tabItems()` and `tabItem()`.

## Wrap Up

Below is the code for your first bs4Dash application:

<details>
<summary>Code</summary>
```{r wrapup-intro, eval=FALSE}
library(shiny)
library(bs4Dash)

shiny::shinyApp(
  ui = bs4DashPage(
    old_school = FALSE,
    sidebar_collapsed = TRUE,
    controlbar_collapsed = TRUE,
    title = "Basic Dashboard",
    navbar = bs4DashNavbar(
      skin = "light",
      status = "white",
      border = TRUE,
      sidebarIcon = "bars",
      controlbarIcon = "th",
      fixed = FALSE,
      leftUi = bs4DropdownMenu(
        show = TRUE,
        align = "left",
        status = "warning", 
        menuIcon = "envelope-open",
        src = NULL
      ),
      rightUi = bs4DropdownMenu(
        show = FALSE,
        status = "danger",
        src = "https://www.google.fr",
        bs4DropdownMenuItem(
          message = "message 1",
          from = "Divad Nojnarg",
          src = "https://adminlte.io/themes/v3/dist/img/user3-128x128.jpg",
          time = "today",
          status = "danger",
          type = "message"
        ),
        bs4DropdownMenuItem(
          message = "message 2",
          from = "Nono Gueye",
          src = "https://adminlte.io/themes/v3/dist/img/user3-128x128.jpg",
          time = "yesterday",
          status = "success",
          type = "message"
        )
      )
    ),
    sidebar = bs4DashSidebar(
      skin = "light",
      status = "primary",
      title = "bs4Dash",
      brandColor = "primary",
      url = "https://www.google.fr",
      src = "https://adminlte.io/themes/AdminLTE/dist/img/user2-160x160.jpg",
      elevation = 3,
      opacity = 0.8,
      bs4SidebarUserPanel(
        img = "https://image.flaticon.com/icons/svg/1149/1149168.svg", 
        text = "Welcome Onboard!"
      ),
      bs4SidebarMenu(
        bs4SidebarHeader("Header 1"),
        bs4SidebarMenuItem(
          "Item 1",
          tabName = "item1",
          icon = "sliders"
        ),
        bs4SidebarMenuItem(
          "Item 2",
          tabName = "item2",
          icon = "id-card"
        )
      )
    ),
    controlbar = bs4DashControlbar(
      skin = "light",
      title = "My right sidebar",
      sliderInput(
        inputId = "obs", 
        label = "Number of observations:",
        min = 0, 
        max = 1000, 
        value = 500
      ),
      column(
        width = 12,
        align = "center",
        radioButtons(
          inputId = "dist", 
          label = "Distribution type:",
          c("Normal" = "norm",
            "Uniform" = "unif",
            "Log-normal" = "lnorm",
            "Exponential" = "exp")
        )
      )
    ),
    footer = bs4DashFooter(
      copyrights = a(
        href = "https://twitter.com/divadnojnarg", 
        target = "_blank", "@DivadNojnarg"
      ),
      right_text = "2018"
    ),
    body = bs4DashBody(
      bs4TabItems(
        bs4TabItem(
          tabName = "item1",
          fluidRow(
            lapply(1:3, FUN = function(i) {
              bs4Sortable(
                width = 4,
                p(class = "text-center", paste("Column", i)),
                lapply(1:2, FUN = function(j) {
                  bs4Card(
                    title = paste0("I am the ", j,"-th card of the ", i, "-th column"), 
                    width = 12,
                    "Click on my header"
                  )
                })
              )
            })
          )
        ),
        bs4TabItem(
          tabName = "item2",
          bs4Card(
            title = "Card with messages",
            width = 9,
            userMessages(
              width = 12,
              status = "success",
              userMessage(
                author = "Alexander Pierce",
                date = "20 Jan 2:00 pm",
                src = "https://adminlte.io/themes/AdminLTE/dist/img/user1-128x128.jpg",
                side = NULL,
                "Is this template really for free? That's unbelievable!"
              ),
              userMessage(
                author = "Dana Pierce",
                date = "21 Jan 4:00 pm",
                src = "https://adminlte.io/themes/AdminLTE/dist/img/user5-128x128.jpg",
                side = "right",
                "Indeed, that's unbelievable!"
              )
            )
          )
        )
      )
    )
  ),
  server = function(input, output) {}
)
```
</details>
<br>

<img src="figures/bs4Dash_wrapup.png">
<br>

Advanced shiny user would probably design shiny modules to generate this page, which I really encourage. However, how to deal with modules is not the purpose of this article.
